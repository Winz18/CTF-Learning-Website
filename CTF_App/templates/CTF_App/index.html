{% extends "CTF_App/base.html" %}

{% block extra_css %}
<style>
    .search-group {
        width: 70%;
        max-width: 900px;
        margin: auto;
    }

    .search-input {
        color: #000;
        background-color: #fff;
        border-radius: 25px;
    }

    .pagination {
        display: flex;
        justify-content: center;
        margin-top: 20px;
    }

    .step-links {
        display: flex;
        gap: 10px;
    }

    .step-links a,
    .step-links span {
        padding: 8px 16px;
        background: #343a40;
        color: #fff;
        text-decoration: none;
        border-radius: 4px;
    }

    .step-links a:hover {
        background: #495057;
    }

    .categories-section {
        margin-top: 20px;
        max-width: 200px;
        margin-left: auto;
        margin-right: auto;
    }

    .categories-section select {
        width: 100%;
        background-color: #343a40;
        color: #fff;
        border: 1px solid #495057;
        border-radius: 5px;
        padding: 5px 10px;
    }

    .categories-section select:focus {
        border-color: #66afe9;
        outline: 0;
        box-shadow: 0 0 10px rgba(102, 175, 233, 0.6);
    }
</style>
{% endblock %}

{% block content %}
<!-- Search bar -->
<div class="search-form mt-3">
    <form action="{% url 'CTF_App:index' %}" method="GET">
        {% csrf_token %}
        <div class="input-group mb-3 search-group">
            <span class="material-symbols-outlined input-group-text">search</span>
            <input class="form-control search-input" name="search" placeholder="Search for articles" type="text" value="{{ search_query }}">
            <button class="btn btn-success" type="submit">Search</button>
        </div>
    </form>

    <div class="categories-section">
    <select class="form-select" aria-label="Categories" onchange="location = this.value;">
        <option value="{% url 'CTF_App:index' %}" {% if not request.GET.category %}selected{% endif %}>All</option>
        <option value="{% url 'CTF_App:index' %}?category=Web Security" {% if request.GET.category == 'Web Security' %}selected{% endif %}>Web Security</option>
        <option value="{% url 'CTF_App:index' %}?category=Forensics" {% if request.GET.category == 'Forensics' %}selected{% endif %}>Forensics</option>
        <option value="{% url 'CTF_App:index' %}?category=Cryptography" {% if request.GET.category == 'Cryptography' %}selected{% endif %}>Cryptography</option>
        <option value="{% url 'CTF_App:index' %}?category=Binary Exploitation" {% if request.GET.category == 'Binary Exploitation' %}selected{% endif %}>Binary Exploitation</option>
        <option value="{% url 'CTF_App:index' %}?category=Reverse Engineering" {% if request.GET.category == 'Reverse Engineering' %}selected{% endif %}>Reverse Engineering</option>
        <option value="{% url 'CTF_App:index' %}?category=Misc" {% if request.GET.category == 'Misc' %}selected{% endif %}>Misc</option>
    </select>
</div>
</div>
<!-- End of search bar -->

<!-- Categories combobox -->

<!-- End of categories combobox -->

<div class="container" style="color: #fff;">
    <div class="row">
        <div class="col text-center">
            <h2>Recent Posts</h2>
        </div>
    </div>
    <div class="row">
        <div class="col-md-8 offset-md-2">
            {% for article in latest_article_list %}
            <div class="card mb-3 bg-dark">
                <div class="card-body">
                    <h5 class="card-title">
                        <a href="{% url 'CTF_App:article_detail' article.id %}" style="color: goldenrod;">
                            {{ article.name }}
                        </a>
                    </h5>
                    <h6 style="color: cadetblue;">Author: {{ article.author }}</h6>
                    <h6 style="color: cadetblue;">Date: {{ article.date }}</h6>
                    <h6 style="color: cadetblue;">Views: {{ article.total_views }}</h6>
                </div>
            </div>
            {% endfor %}
            <div class="pagination">
                <span class="step-links">
                    {% if latest_article_list.has_previous %}
                        <a href="?page=1">&laquo; first</a>
                        <a href="?page={{ latest_article_list.previous_page_number }}">previous</a>
                    {% endif %}

                    <span class="current">
                        Page {{ latest_article_list.number }} of {{ latest_article_list.paginator.num_pages }}.
                    </span>

                    {% if latest_article_list.has_next %}
                        <a href="?page={{ latest_article_list.next_page_number }}">next</a>
                        <a href="?page={{ latest_article_list.paginator.num_pages }}">last &raquo;</a>
                    {% endif %}
                </span>
            </div>
        </div>
    </div>
</div>
{% endblock %}
